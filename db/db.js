"use strict";const check=require("check-types"),MongoClient=require("mongodb").MongoClient,Promise=require("bluebird");let db=null;module.exports.db=function(){if(null===db)throw new Error("Mongo DB not connected!");return db},module.exports.connect=function(e){if(null!==db)return Promise.resolve(db);try{check.assert.object(e,"Invalid connection object."),check.assert.string(e.host,"Invalid connection.host."),check.assert.number(e.port,"Invalid connection.port."),check.assert.string(e.dbName,"Invalid connection.dbName.")}catch(e){return Promise.reject(e)}return new Promise((n,o)=>{MongoClient.connect("mongodb://"+e.host+":"+e.port+"/"+e.dbName,{promiseLibrary:Promise},(e,r)=>{if(e)return o(e);db=r,n(r)})})};